"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4484],{49756:function(e,n,t){t.d(n,{Z:function(){return Y}});var r=t(47568),i=t(26042),s=t(69396),o=t(29815),a=t(97582),c=t(85893),l=t(67294),u=t(84082),d=t(60994),m=t(87261),f=t(26683),v=t(89355),p=t(89885),h=t(73716),x=t(24271),g=t(96486),j=t(3751),b=t(91444),y=t(67814),N=t(59417),_=t(39886),Z=t(54610),w=function(e){var n=e.room,t=e.onRoomSelect;return(0,c.jsx)(_.Z,{onClick:function(){return t(n)},className:"rounded-0 cursor-pointer",children:(0,c.jsxs)(Z.Z,{className:"p-3 font-semi-bold d-flex align-items-center",children:[n.room_name,(0,c.jsx)(y.G,{icon:N.eFW,color:"gray",className:"ms-auto"})]})})};var C=t(97340),k=t(35773),S=t(95305),E=function(e){var n=e.src,t=(0,l.useRef)(null),r=(0,l.useState)(!1),i=r[0],s=r[1],o=(0,l.useState)(0),a=o[0],d=o[1],f=(0,l.useState)(0),v=f[0],p=f[1],h=(0,l.useState)(1),x=h[0],g=h[1],j=(0,l.useState)(1),b=j[0],_=j[1];(0,l.useEffect)((function(){var e=t.current;if(e){var n=function(n){e.duration!==1/0&&(p(e.duration),e.currentTime===e.duration&&(e.currentTime=0,d(0))),d(e.currentTime)},r=function(t){e.duration===1/0||isNaN(Number(e.duration))?(e.currentTime=1e101,e.addEventListener("timeupdate",n)):p(e.duration)};return e.addEventListener("timeupdate",n),e.addEventListener("loadedmetadata",r),function(){e.removeEventListener("timeupdate",n),e.removeEventListener("loadedmetadata",r)}}}),[]);var Z=function(e){if(e===1/0)return"--:--";var n=Math.floor(e/60),t=Math.floor(e%60);return"".concat(n,":").concat(t<10?"0":"").concat(t)};return(0,c.jsxs)("div",{className:"audio-player",children:[(0,c.jsx)("audio",{ref:t,src:n}),(0,c.jsxs)(k.Z,{className:"align-items-center",children:[(0,c.jsx)(S.Z,{xs:"auto",children:(0,c.jsx)(u.Z,{color:"primary",onClick:function(){var e=t.current;e&&(i?e.pause():e.play(),s(!i))},children:(0,c.jsx)(y.G,{icon:i?N.XQY:N.zc})})}),(0,c.jsxs)(S.Z,{children:[(0,c.jsx)("div",{className:"slider-container",children:(0,c.jsx)(m.Z,{type:"range",min:"0",max:v,value:a,onChange:function(e){var n=t.current;if(n){var r=Number(e.target.value);n.currentTime=r,d(r)}},className:"time-slider"})}),(0,c.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,c.jsx)("small",{children:Z(a)}),(0,c.jsx)("small",{children:Z(v)})]})]}),(0,c.jsx)(S.Z,{xs:"auto",children:(0,c.jsx)(u.Z,{color:"secondary",className:"btn-playback-speed",onClick:function(){var e=1===x?2:1,n=t.current;n&&(n.playbackRate=e,g(e))},children:"".concat(x,"x")})}),(0,c.jsxs)(S.Z,{xs:"auto",className:"d-flex align-items-center",children:[(0,c.jsx)(y.G,{icon:b>0?N.ihg:N.YLJ}),(0,c.jsx)(m.Z,{type:"range",min:"0",max:"1",step:"0.01",value:b,onChange:function(e){var n=t.current;if(n){var r=Number(e.target.value);n.volume=r,_(r)}},className:"volume-slider"})]})]})]})},D=t(62922);function R(e){var n=e.videoDetails,t=e.firebase,r=e.selectedRoomPath,s=(0,l.useState)(n),o=s[0],a=s[1];return(0,l.useEffect)((function(){var e=(0,v.N8)(t),n=(0,v.iH)(e,"".concat(r,"/").concat(o.key));return(0,v.jM)(n,(function(e){var n=e.key,t=e.val();a((0,i.Z)({key:n},t))})),function(){(0,v.S1)(n)}}),[r,t,o.key]),(0,l.useEffect)((function(){a(n)}),[n]),(0,c.jsx)("div",{className:"row",children:(0,c.jsxs)("div",{className:"col",children:[(0,c.jsx)("div",{className:"font-semi-bold",children:o.title}),(0,c.jsx)("img",{src:o.image,className:"d-block mx-auto",style:{maxWidth:"100%",height:"auto"},alt:"User Image"}),(0,c.jsx)("div",{className:"text-center mt-4",children:function(){if("UPCOMING"===o.streamStatus)return(0,c.jsxs)("div",{className:"text-danger",children:["Will be live on ",(0,D.vF)(o.liveOn)]});if("LIVE"===o.streamStatus){return(0,c.jsx)(u.Z,{style:{width:"100%",maxWidth:"200px"},color:"primary",onClick:function(e){e.stopPropagation(),function(){var e,n;window.open("/video/".concat(o.videoId,"?courseId=").concat(o.courseId,"&ytFlag=").concat(o.ytFlag,"&isFolderCourse=").concat(o.folderWiseCourse?1:0,"&lcId=").concat(null!==(e=o.lcId)&&void 0!==e?e:"","&lcApi=").concat(null!==(n=o.lcApi)&&void 0!==n?n:""),"_blank")}()},children:"Watch"})}return(0,c.jsx)("div",{className:"text-center text-danger",children:"Livestream has ended"})}()})]})})}var A=t(56599),P=t(25062),I=t(21359),L=t(18446),M=t.n(L),F={0:{status:"PAUSED",icon:N.diR,color:"warning",text:"Poll Inactive"},1:{status:"LIVE",icon:N.diR,color:"success",text:"Active Poll"},2:{status:"ENDED",icon:N.diR,color:"danger",text:"Poll Ended"}};function U(e){var n=e.poll,t=e.selectedRoomPath,i=e.firebase,s=e.id,u=(0,l.useContext)(p.Z).currentUser,d=(0,l.useState)(n),m=d[0],f=d[1],h=(0,l.useMemo)((function(){return(0,v.N8)(i)}),[i]),x=(0,l.useMemo)((function(){return"/data/polls_course_room/".concat(n.pollId,"/poll")}),[n.pollId]),g=(0,l.useMemo)((function(){return"".concat(t,"/").concat(s)}),[t,s]),b=(0,l.useMemo)((function(){return(0,v.iH)(h,x)}),[h,x]),N=(0,l.useMemo)((function(){return(0,v.iH)(h,"".concat(x,"/activePoll"))}),[h,x]),Z=(0,l.useMemo)((function(){return(0,v.iH)(h,"".concat(x,"/activePollAnswer"))}),[h,x]),w=(0,l.useState)(null),C=w[0],k=w[1],S=(0,l.useState)(null),E=S[0],D=S[1],R=(0,l.useState)(!1),L=R[0],U=R[1],T=(0,l.useState)(null),G=T[0],z=T[1],H=(0,l.useState)(!1),O=H[0],W=H[1],q=(0,l.useState)([]),V=q[0],Y=q[1],B=(0,j.useTimer)({autoStart:!1,expiryTimestamp:new Date}),K=function(e){var n=!(0,I.Z)(null===C||void 0===C?void 0:C.answer);return(0,I.Z)(G)||!n?e.selected?{background:"#146fe6",color:"white"}:{background:"white"}:e.isAnswer?{background:"#25c16f",color:"white"}:e.selected&&!e.isAnswer?{background:"#dc3545",color:"white"}:void 0},$=(0,l.useCallback)(function(){var e=(0,r.Z)((function(e){var n,t,r,i,s,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=u,"1"==="".concat(m.pollStatus)&&n?(W(!0),[4,Q()]):[3,2];case 1:if(a.sent())return W(!1),[2];r=!(0,I.Z)(null===C||void 0===C?void 0:C.answer),(i={})["/activePollAnswer/option".concat(e)]=(0,v.nP)(1),s=!r||(null===C||void 0===C||null===(t=C.answer)||void 0===t?void 0:t.includes(e)),o={isCorrect:s,name:n.name,selectedOptionAnswers:[e],source:"website"},z(o),i["/userAnswers/user_".concat(n.userid)]=o,(0,v.Vx)(b,i),W(!1),a.label=2;case 2:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[u,C,E,t,s]),Q=(0,l.useCallback)((0,r.Z)((function(){var e,n,t;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return u?(e=(0,v.iH)(h,"".concat(x,"/userAnswers/user_").concat(u.userid)),[4,(0,v.U2)(e)]):[3,2];case 1:return n=r.sent(),(t=null===n||void 0===n?void 0:n.val())?(z(t),[2,t]):[2,null];case 2:return[2,null]}}))})),[u]),X=(0,l.useCallback)((function(){(0,v.U2)(Z).then((function(e){var n=e.val();if(n){var t=(0,o.Z)(new Array(null===C||void 0===C?void 0:C.totalOptions)).map((function(e,t){return n["option".concat(t)]})).reduce((function(e,n){return e+n})),r=(0,o.Z)(new Array(null===C||void 0===C?void 0:C.totalOptions)).map((function(e,r){var i,s;return{id:r,selected:null===G||void 0===G||null===(i=G.selectedOptionAnswers)||void 0===i?void 0:i.includes(r),isAnswer:!(0,I.Z)(null===C||void 0===C?void 0:C.answer)&&(null===C||void 0===C||null===(s=C.answer)||void 0===s?void 0:s.includes(r)),option:null===C||void 0===C?void 0:C.options[r],votes:0==t?0:Math.round(n["option".concat(r)]/t*100)}}));Y(r)}}))}),[Z,C,G]);return(0,l.useEffect)((function(){return(0,v.U2)(N).then((function(e){if(e.exists()){var n=e.val();n&&(k(n.activePollData),D(n.pollConfig),n.pollConfig.pollDuration>0&&B.restart(new Date(n.activePollData.createdAt+n.pollConfig.pollDuration),!0))}})),function(){return(0,v.S1)(N,"value")}}),[N]),(0,l.useEffect)((function(){Q()}),[Q,L,O]),(0,l.useEffect)((function(){var e=null;return G?(X(),e=setInterval((function(){X()}),(null===E||void 0===E?void 0:E.updateVoteDuration)||5e3)):e&&clearInterval(e),function(){e&&clearInterval(e)}}),[G,X]),(0,l.useEffect)((function(){return(0,v.jM)((0,v.iH)(h,g),(function(e){var n=e.val();M()(n,m)||f(n)})),function(){return(0,v.S1)((0,v.iH)(h,g),"value")}}),[g]),(0,c.jsxs)(_.Z,{color:"light",className:"mt-2 rounded-1 poll-card position-sticky top-0",children:[(0,c.jsxs)(A.Z,{onClick:function(){return U(!L)},className:"font-semi-bold cursor-pointer border-bottom-0",children:[(0,c.jsx)("span",{children:m.question}),(0,c.jsxs)(P.Z,{color:"white",className:"float-end mt-1 text-dark",style:{backgroundColor:F[m.pollStatus].color},children:[(0,c.jsx)(y.G,{icon:F[m.pollStatus].icon,style:{fontSize:"9px"},beatFade:"LIVE"===F[m.pollStatus].status,className:"me-1 text-".concat(F[m.pollStatus].color)}),F[m.pollStatus].text]})]}),(0,c.jsx)("div",{className:"".concat(L?"max-h-full opacity-100":"max-h-0 opacity-0"," transition-all duration-300 ease-in-out overflow-hidden"),children:(0,c.jsxs)("div",{className:"justify-content-start py-2 gap-2",children:[(0,I.Z)(G)||(0,I.Z)(V)?(0,o.Z)(new Array(null===C||void 0===C?void 0:C.totalOptions)).map((function(e,n){return(0,c.jsx)("div",{className:"border bg-white rounded-1 px-3 py-2 m-2",onClick:function(){return!O&&"1"===m.pollStatus&&$(n)},"aria-disabled":O||"1"!==m.pollStatus,role:"button",children:(null===C||void 0===C?void 0:C.options)&&C.options[n]},n)})):V.map((function(e){return(0,c.jsxs)("div",{style:K(e),className:"border rounded-1 px-3 py-2 m-2 position-relative",children:[(0,c.jsxs)("div",{style:{zIndex:"100"},className:"position-relative d-flex justify-content-between font-semi-bold",children:[e.option," ",!(null===E||void 0===E?void 0:E.enablePrivatePoll)&&(0,c.jsxs)("div",{children:[e.votes,"%"]})]}),!(null===E||void 0===E?void 0:E.enablePrivatePoll)&&(0,c.jsx)("div",{style:{width:e.votes+"%",zIndex:"1",borderRadius:"0.5rem 0 0 0.5rem",background:"#443f4040"},className:"position-absolute top-0 start-0 h-100"})]},e.option)})),B.isRunning&&(0,c.jsxs)("div",{className:"ps-3 sub-text mb-2",children:["Poll ends in: ",(0,c.jsx)("b",{children:B.seconds+60*B.minutes})," ","secs"]})]})})]})}var T={audio:N.nfZ,pdf:"/icons/pdf.svg",video:N.hvm},G=function(e){var n=e.message,t=e.openPdf,r=e.openVideo,i=e.firebaseConfig,s=e.selectedRoomPath,o=n.type,a=void 0===o?"":o,l=n.url,u=void 0===l?"":l,d=n.userComment,m=void 0===d?"":d,f=a.toLowerCase();if("poll"===f)return(0,c.jsx)(U,{poll:n,selectedRoomPath:s,firebase:i,id:n.key});if("pdf"===f&&!(0,I.Z)(u))return(0,c.jsxs)("div",{className:"row",role:"button",onClick:function(){return t({link:u,save_flag:"1",is_encrypted:"0",encryption_key:"",encryption_version:"1"})},children:[(0,c.jsx)("div",{className:"col-4",children:(0,c.jsx)("img",{src:T.pdf,style:{maxWidth:"100%",height:"auto"},alt:"PDF Icon"})}),m&&(0,c.jsx)("div",{className:"col-8",children:(0,h.i5)(m)})]});if("video"===f&&!(0,I.Z)(u))return(0,c.jsxs)("div",{className:"row",role:"button",onClick:function(){return r({link:u})},children:[(0,c.jsx)("div",{className:"col-4",children:(0,c.jsx)(y.G,{icon:T.video,color:"#6549f6",size:"3x"})}),m&&(0,c.jsx)("div",{className:"col-8",children:(0,h.i5)(m)})]});if("audio"===f&&!(0,I.Z)(u))return(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"col",children:(0,c.jsx)(E,{src:u})})});if("live_video"===f)return(0,c.jsx)(R,{videoDetails:n,firebase:i,selectedRoomPath:s});if("image"===f&&"image"in n&&!(0,I.Z)(n.image)){var v=n.image;return(0,c.jsx)("div",{className:"row",children:(0,c.jsxs)("div",{className:"col",children:[(0,c.jsx)("img",{src:v,style:{maxWidth:"100%",height:"auto"},alt:"User Image"}),m&&(0,c.jsx)("div",{className:"mt-2",children:(0,h.i5)(m)})]})})}return(0,c.jsx)("div",{className:"font-semi-bold",children:(0,c.jsx)(C.Z,{options:{target:"_blank",rel:"noopener noreferrer"},children:(0,h.i5)(m)})})},z=function(e){var n=e.message,t=n.userId,r=n.userName,i=n.userTime,s=n.postedAt,o=(0,l.useContext)(p.Z).currentUser;return(0,l.useEffect)((function(){return document.addEventListener("selectstart",(function(e){e.preventDefault()})),document.addEventListener("copy",(function(e){e.preventDefault()})),document.addEventListener("cut",(function(e){e.preventDefault()})),function(){document.removeEventListener("selectstart",(function(e){e.preventDefault()})),document.removeEventListener("copy",(function(e){e.preventDefault()})),document.removeEventListener("cut",(function(e){e.preventDefault()}))}}),[]),(0,c.jsx)("div",{className:"chatmsg",children:(0,c.jsx)("div",{className:"col-md-8 col-xs-8 m-t-10 ".concat(t===o.userid?"offset-md-4 offset-xs-4":""),children:(0,c.jsxs)("div",{className:"messages msg_sent rounded-1",children:[G(e),(0,c.jsxs)("time",{className:"text-gray font-xs w-100 d-flex justify-content-between",children:[(0,c.jsx)("span",{children:r}),(0,c.jsx)("span",{children:(0,D.by)(i,s)})]})]})})})},H=t(63469),O=t(65356),W=t(11163),q=t(99209),V=t(45508);function Y(e){var n=(0,l.useState)([]),t=n[0],_=n[1],Z=(0,l.useState)(!1),C=Z[0],k=Z[1],S=(0,l.useState)([]),E=S[0],D=S[1],R=(0,l.useState)(),A=R[0],P=R[1],I=(0,l.useState)(!1),L=I[0],M=I[1],F=(0,l.useState)(null),U=F[0],T=F[1],G=(0,l.useState)(null),Y=G[0],B=G[1],K=null,$=(0,l.useRef)(null),Q=(0,l.useRef)(null),X=(0,l.useContext)(p.Z),J=X.currentUser,ee=X.appConfig,ne=(0,j.useTimer)({autoStart:!1,expiryTimestamp:new Date}),te=e.course,re=e.isFolderCourse,ie=(0,l.useState)(),se=ie[0],oe=ie[1],ae=(0,l.useState)(""),ce=ae[0],le=ae[1],ue=(0,l.useState)(null),de=ue[0],me=ue[1],fe=(0,W.useRouter)(),ve=(0,l.useCallback)((0,r.Z)((function(){var e,n,t,r;return(0,a.__generator)(this,(function(i){switch(i.label){case 0:if(e=fe.query.lcId?"[LINKEDCOURSE-".concat(11,"-").concat(fe.query.lcId,"]"):"[DEFAULT]",n=ee.web_firebaseconfig,!fe.query.lcId||!(0,x.gG)(e))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,q.OF)({lcId:fe.query.lcId,lcApi:(0,V.NA)(fe.query.api)})];case 2:return n=i.sent(),[3,4];case 3:return t=i.sent(),console.error("Error in getting firebase config",t),[3,4];case 4:return r=(0,x.G5)(n,e),me(r),[2]}}))})),[fe.query.lcId,fe.query.api,ee.web_firebaseconfig]);(0,l.useEffect)((function(){ve()}),[ve]),(0,l.useEffect)((function(){if(!(0,g.isEmpty)(J)&&de){oe(!0);var e=(0,v.N8)(de),n=re?"/folderCourseRoom/user/".concat(te.id,"/").concat(J.userid):"/data/CourseRoom/user/".concat(te.id,"/").concat(J.userid),t=(0,v.iH)(e,n),i=(0,v.iH)(e,"/data/user_block_status/"+J.userid),s=re?"/folderCourseRoom/"+te.id:"/data/CourseRoom/"+te.id;return(0,v.jM)(t,function(){var n=(0,r.Z)((function(n){var t,r,i,o,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return(t=n.val()||[]).push("room_"+te.id),r=t.map((function(n){return(0,v.U2)((0,v.iH)(e,"".concat(s,"/").concat(n)))})),[4,Promise.all(r)];case 1:return i=a.sent(),o=i.map((function(e){return(null===e||void 0===e?void 0:e.exists())?e.val():null})).filter((function(e){return null!=e})),D(o),(0,g.isEmpty)(o)&&(c={room_id:"room_"+te.id,room_name:"General",created_at:(new Date).getTime(),room_image:""},(0,v.t8)((0,v.iH)(e,s+"/room_"+te.id),c),D([c])),oe(!1),[2]}}))}));return function(e){return n.apply(this,arguments)}}()),(0,v.jM)(i,(function(e){var n=e.val();k(1==n)})),function(){(0,v.S1)(t,"value"),(0,v.S1)(i,"value"),D([])}}}),[J,de,null===te||void 0===te?void 0:te.id,re]),(0,l.useEffect)((function(){pe()}),[t]),(0,l.useEffect)((function(){if(A){if(de){var e=(0,v.N8)(de),n=re?"/folderCourseRoomChat/"+A.room_id:"/data/CourseRoomChat/"+A.room_id;return K=(0,v.iH)(e,n),_([]),le(n),(0,v.yv)(K,(function(e){var n=e.val();_((function(t){return t.some((function(n){return n.key===e.key}))?t:(0,o.Z)(t).concat([(0,s.Z)((0,i.Z)({},n),{key:e.key})])}))})),(0,v.MQ)(K,(function(e){_((function(n){return n.some((function(n){return n.key===e.key}))?n.filter((function(n){return n.key!==e.key})):n}))})),function(){(0,v.S1)(K,"child_added"),(0,v.S1)(K,"child_removed")}}}else le("")}),[A]);var pe=function(){var e=document.getElementById("msgContainer");e&&(e.scrollTop=e.scrollHeight)},he=function(){var e,n=null===(e=$.current.value)||void 0===e?void 0:e.trim(),t=(0,h.MI)(n);if((0,h.$N)(n))return $.current.value=t,void b.Am.warn("URLs are not allowed");if(!((null===A||void 0===A?void 0:A.only_admin_can_message)||(0,g.isEmpty)(null===t||void 0===t?void 0:t.trim())||C))if(ne.isRunning)b.Am.info("You can send the next message after ".concat(ne.seconds," seconds"));else{var r={userName:J.name,userComment:t,userFlag:"0",userTime:(0,h.xv)(),postedAt:(new Date).getTime(),userId:J.userid,pinstatus:"0"};if(de){var i=(0,v.N8)(de),s=re?"/folderCourseRoomChat/"+A.room_id:"/data/CourseRoomChat/"+A.room_id;K=(0,v.iH)(i,s),(0,v.VF)(K,{}).then((function(e){var n=e.key,t=(0,v.iH)(i,s+"/"+n);(0,v.t8)(t,r),$.current.value=""}))}}},xe=function(e){T(e)},ge=function(e){B(e)},je=function(e){P(e)};return(0,c.jsxs)("div",{children:[(0,c.jsx)(u.Z,{size:"lg",color:"primary",className:"btn-rounded position-fixed",onClick:function(){return M(!L)},style:{bottom:"1rem",right:"1rem",zIndex:"100"},children:(0,c.jsx)(y.G,{icon:N.lXL})}),L&&(0,c.jsxs)("div",{className:"panel panel-default position-fixed rounded overflow-hidden",style:{bottom:"5rem",right:"1rem",zIndex:"100",maxWidth:"500px",width:"95%"},children:[se&&(0,c.jsx)(y.G,{color:"gray",icon:N.LM3,size:"2x",spin:!0,className:"position-absolute center"}),(0,c.jsxs)("div",{className:"panel-heading top-bar font-bold font-lg",children:[A?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(y.G,{icon:N.jio,className:"me-2 cursor-pointer",color:"gray",onClick:function(){return P(null)}}),A.room_name]}):"Select a room",(0,c.jsx)(u.Z,{color:"link",className:"p-0 float-end",onClick:function(){return M(!1)},children:(0,c.jsx)(y.G,{icon:N.nYk})})]}),A?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"panel-body msg_container_base",id:"msgContainer",children:[t.map((function(e,n){return(0,c.jsx)(z,{message:e,firebaseConfig:de,selectedRoomPath:ce,openPdf:xe,openVideo:ge},"".concat(e.key,"-").concat(n))})),(0,c.jsx)("div",{style:{float:"lef",clear:"both"},ref:Q})]}),(0,c.jsx)("div",{className:"panel-footer",children:(0,c.jsxs)(d.Z,{children:[(0,c.jsx)(m.Z,{type:"text",placeholder:"Write your message here ...",innerRef:$,disabled:null===A||void 0===A?void 0:A.only_admin_can_message,onKeyDown:function(e){"Enter"==e.key&&he()},name:"typedMessage",className:"mb-0"}),(0,c.jsx)(u.Z,{color:"primary",id:"btn-chat",disabled:null===A||void 0===A?void 0:A.only_admin_can_message,onClick:he,children:"Send"})]})})," "]}):(0,c.jsx)("div",{className:"panel-body msg_container_base p-0",children:E.map((function(e){return(0,c.jsx)(w,{room:e,onRoomSelect:je},e.room_id)}))})]}),U&&(0,c.jsx)(O.Z,{isOpen:!!U,toggle:function(){T(null)},link:U.link,allowDownload:null===U||void 0===U?void 0:U.save_flag,encryptionKey:U.pdf_encryption_key||"",isEncrypted:U.is_pdf_encrypted||"",encryptionVersion:(null===U||void 0===U?void 0:U.pdf_encryption_version)||""}),Y&&(0,c.jsx)(f.Z,{isOpen:!0,toggle:function(){B(null)},children:(0,c.jsx)(H.Z,{src:Y.link})})]})}},48927:function(e,n,t){t.d(n,{Z:function(){return L}});var r=t(85893),i=t(59417),s=t(67814),o=t(67294),a=t(35773),c=t(95305),l=t(84082),u=t(47568),d=t(97582),m=t(91444),f=t(23138),v=t(39886),p=t(54610),h=t(87261),x=t(3126),g=t(99209),j=t(89885),b=t(25062),y=t(47911),N=t(30381),_=t.n(N),Z=t(97340),w=t(45508),C=t(65356),k=t(96486);function S(e){var n=e.doubt,t=e.deleteDoubt,a=(0,o.useState)(!1),c=a[0],u=a[1],d=(0,o.useCallback)((function(){return u(!c)})),m=(0,o.useState)(""),f=m[0],h=m[1],x=(0,o.useCallback)((function(e){d(),h(e)}),[d]);return(0,r.jsxs)(v.Z,{className:"mb-4",children:[(0,r.jsxs)(p.Z,{children:[(0,r.jsxs)("div",{className:"font-bold font-lg",children:[n.user_name," ",n.examName&&(0,r.jsx)(b.Z,{color:"primary-light",pill:!0,className:"text-dark border ms-2",children:n.examName}),t&&(0,r.jsx)(s.G,{icon:i.$aW,color:"gray",className:"float-end",onClick:function(e){e.stopPropagation(),t(n.id)}})]}),(0,r.jsx)("div",{className:"sub-text",children:_()(n.datetime).utc(!0).fromNow()}),(0,r.jsx)("div",{children:(0,r.jsx)(Z.Z,{options:{target:"_blank",rel:"noopener noreferrer"},children:n.doubt||n.comment})})]}),n&&((0,k.isEmpty)(n.pdf)?(0,k.isEmpty)(n.image)?null:(0,r.jsx)(y.Z,{className:"border-top bg-light",src:n.image,bottom:!0,style:{objectPosition:"top",objectFit:"contain",maxHeight:"500px"}}):(0,r.jsxs)("div",{className:"border-top bg-light p-2 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(s.G,{icon:i.gMD}),(0,r.jsx)("span",{children:n.pdf_name||"Attached PDF"})]}),(0,r.jsx)(l.Z,{size:"sm",onClick:function(e){e.stopPropagation(),x(n.pdf)},children:"View PDF"})]})),f&&(0,r.jsx)(C.Z,{isEncrypted:"",encryptionKey:"",encryptionVersion:"",isOpen:c,toggle:d,link:(0,w.NA)(f)})]},n.id)}var E=t(58907),D=t(73716);function R(e){var n=e.selectedDoubt,t=(0,o.useState)(),a=t[0],c=t[1],b=(0,o.useRef)(null),y=(0,o.useState)(),N=y[0],_=y[1],Z=(0,o.useContext)(j.Z).currentUser,w=(0,o.useState)(),C=w[0],k=w[1];(0,o.useEffect)((function(){R()}),[]);var R=function(){var e=(0,u.Z)((function(){var e;return(0,d.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,g.B8)(n.id)];case 1:return e=t.sent(),c(e),[2]}}))}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,u.Z)((function(){var e,t,r,i,s;return(0,d.__generator)(this,(function(o){switch(o.label){case 0:return e=b.current.value,t=(0,D.MI)(e),(0,D.$N)(t)?(b.current.value=t,m.Am.warn("URLs are not allowed",{position:"bottom-right"}),[2]):(k(!0),r={comment:t,doubt_id:n.id,user_id:Z.userid,user_name:Z.username,image:""},N?(i=Date.now()+N.name,[4,(0,E.s)({fileName:i,file:N,path:"doubt-images/".concat(n.id)})]):[3,2]);case 1:s=o.sent(),"application/pdf"===N.type?r.pdf_url=s.Location:r.image_url=s.Location,o.label=2;case 2:return[4,(0,g.hb)(r)];case 3:return o.sent(),m.Am.success("Your comment has been posted"),b.current.value="",k(!1),_(),R(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,u.Z)((function(e){return(0,d.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,g.Nn)(e)];case 1:return n.sent(),m.Am.success("Your comment has been removed"),R(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,r.jsxs)("div",{children:[(0,r.jsx)(S,{doubt:n}),(0,r.jsx)("h6",{children:"Comments"}),(null===a||void 0===a?void 0:a.length)>0?(0,r.jsx)(r.Fragment,{children:null===a||void 0===a?void 0:a.map((function(e){return(0,r.jsx)(S,{doubt:e,deleteDoubt:Z.userid==e.user_id?P:""},e.id)}))}):(0,r.jsx)(f.Z,{color:"primary",className:"col-span-full",children:"No comments yet"}),(0,r.jsx)(v.Z,{className:"mb-4",children:(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(h.Z,{innerRef:b,type:"textarea",className:"mb-3",name:"comment"}),(0,r.jsxs)("div",{className:"flex items-center justify-end",children:[(0,r.jsx)("div",{className:"mr-3",children:null===N||void 0===N?void 0:N.name}),(0,r.jsx)(h.Z,{accept:"image/jpeg, image/jpg, image/png, application/pdf",type:"file",className:"hidden",id:"asset",onChange:function(e){return _(e.target.files[0])}}),(0,r.jsx)(x.Z,{className:"mb-0",htmlFor:"asset",children:(0,r.jsx)(s.G,{size:"lg",color:"gray",className:"mr-3",icon:i.Alc})}),(0,r.jsxs)(l.Z,{className:"float-right",disabled:C,onClick:A,children:[C&&(0,r.jsx)(s.G,{icon:i.LM3,className:"mr-2",spin:!0}),"Reply"]})]})]})})]})}var A=t(89163),P=t(96076);function I(e){var n,t=e.courseId,a=e.setSelectedDoubt,c=e.isFolderCourse,b=e.isMyDoubtsEnabled,y=e.isAllDoubtsEnabled,N=(0,o.useContext)(j.Z),_=N.currentUser,Z=(N.appConfig,(0,o.useState)([])),w=Z[0],C=Z[1],R=(0,o.useState)([]),I=R[0],L=R[1],M=(0,o.useState)([]),F=M[0],U=M[1],T=(0,o.useState)(""),G=T[0],z=T[1],H=(0,o.useState)({}),O=H[0],W=H[1],q=(0,o.useState)("1"==b&&"0"==y),V=q[0],Y=q[1],B=(0,o.useState)(),K=B[0],$=B[1],Q=(0,o.useState)(),X=Q[0],J=Q[1],ee=(0,o.useRef)(null);(0,o.useEffect)((function(){0==I.length&&(0,g.P2)(t).then((function(e){return L(e)})),0==F.length&&(0,g.Os)(t).then((function(e){return U(e)}))}),[]),(0,o.useEffect)((function(){_&&ne()}),[V,_]);var ne=function(){var e=(0,u.Z)((function(){var e;return(0,d.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,g.Rr)(t,V?null===_||void 0===_?void 0:_.userid:"")];case 1:return e=n.sent(),C(e),[2]}}))}));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,u.Z)((function(){var e,n,r,i,s;return(0,d.__generator)(this,(function(o){switch(o.label){case 0:return e=ee.current.value,n=(0,D.MI)(e),(0,k.isEmpty)(null===n||void 0===n?void 0:n.trim())?(m.Am.error("Please enter a comment"),[2]):(0,D.$N)(e)?(ee.current.value=n,m.Am.warn("URLs are not allowed",{position:"bottom-right"}),[2]):(null===F||void 0===F?void 0:F.length)>0&&(0,k.isEmpty)(O)?(m.Am.error("Please select a teacher"),[2]):(J(!0),r={doubt:n,exam_id:G,user_id:_.userid,user_name:_.name,course_id:t,teacher_id:(null===O||void 0===O?void 0:O.id)||-1,teacher_name:(null===O||void 0===O?void 0:O.name)||"",image:"",folder_wise_course:c},K?(i=Date.now()+K.name,[4,(0,E.s)({fileName:i,file:K,path:"doubt-images"})]):[3,2]);case 1:s=o.sent(),"application/pdf"===K.type?r.pdf_url=s.Location:r.image_url=s.Location,o.label=2;case 2:return[4,(0,g.Hh)(r)];case 3:return o.sent(),ee.current.value="",$(),z(""),W({}),m.Am.success("Your doubt has been posted"),J(!1),ne(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),re=function(){var e=(0,u.Z)((function(e){return(0,d.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,g.hc)(e)];case 1:return n.sent(),m.Am.success("Your doubt has been deleted"),ne(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,r.jsxs)("div",{children:[(0,r.jsx)(v.Z,{className:"mb-4",children:(0,r.jsxs)(p.Z,{children:[(null===I||void 0===I?void 0:I.length)>0&&(0,r.jsxs)(A.Z,{children:[(0,r.jsx)(x.Z,{children:"Choose Exam"}),(0,r.jsxs)(h.Z,{bsSize:"sm",type:"select",name:"exam",onChange:function(e){return z(e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Select exam"}),I.map((function(e){return(0,r.jsx)("option",{value:e.id,children:e.exam_name},e.id)}))]})]}),(null===F||void 0===F?void 0:F.length)>0&&(0,r.jsxs)(A.Z,{children:[(0,r.jsx)(x.Z,{className:"required",children:"Choose Teacher"}),(0,r.jsxs)(h.Z,{bsSize:"sm",type:"select",name:"teacher",onChange:function(e){return W(F.find((function(n){return n.id==e.target.value})))},children:[(0,r.jsx)("option",{value:"",children:"Select Teacher"}),F.map((function(e){return(0,r.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),(0,r.jsxs)(A.Z,{children:[(0,r.jsx)(x.Z,{children:"Enter Comment"}),(0,r.jsx)(h.Z,{innerRef:ee,type:"textarea",name:"doubt"})]}),(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-end",children:[(0,r.jsx)("div",{className:"me-3",children:"application/pdf"===(null===K||void 0===K?void 0:K.type)?(0,r.jsx)("a",{href:URL.createObjectURL(K),target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(s.G,{icon:i.gMD})}):(null===K||void 0===K||null===(n=K.type)||void 0===n?void 0:n.startsWith("image/"))?(0,r.jsx)("img",{src:URL.createObjectURL(K),alt:"preview",style:{maxHeight:80,maxWidth:80}}):null===K||void 0===K?void 0:K.name}),(0,r.jsx)(h.Z,{accept:"image/jpeg, image/jpg, image/png, application/pdf",type:"file",className:"d-none",id:"asset",onChange:function(e){var n=e.target.files[0];if(n)if(n.size>P.Tb){var t=(n.size/1048576).toFixed(2);m.Am.error("File size (".concat(t," MB) exceeds 50MB limit"))}else $(n)}}),(0,r.jsx)(x.Z,{className:"mb-0",htmlFor:"asset",children:(0,r.jsx)(s.G,{size:"lg",color:"gray",className:"me-3",icon:i.Alc})}),(0,r.jsxs)(l.Z,{className:"float-end",disabled:X,onClick:te,children:[X&&(0,r.jsx)(s.G,{icon:i.LM3,className:"me-2",spin:!0}),"Post Doubt"]})]})]})}),(0,r.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2 mt-4",children:[(0,r.jsx)("h1",{className:"font-g font-bold text-xl",children:"Doubts"}),"0"!=b&&"0"!=y&&(0,r.jsxs)(A.Z,{switch:!0,children:[(0,r.jsx)(x.Z,{children:"My Doubts"}),(0,r.jsx)(h.Z,{type:"switch",disabled:"0"==y,checked:V,onChange:function(e){return Y(!V)}})]})]}),(null===w||void 0===w?void 0:w.length)>0?(0,r.jsx)(r.Fragment,{children:w.map((function(e){var n;return e.examName=null===(n=null===I||void 0===I?void 0:I.find((function(n){return n.id==e.exam_id})))||void 0===n?void 0:n.exam_name,(0,r.jsx)("div",{className:"cursor-pointer",onClick:function(){return a(e)},children:(0,r.jsx)(S,{doubt:e,deleteDoubt:_.userid==e.user_id?re:""})},e.id)}))}):(0,r.jsx)(f.Z,{color:"primary",children:"No doubts posted"})]})}function L(e){var n=e.courseId,t=e.isFolderCourse,u=e.isMyDoubtsEnabled,d=e.isAllDoubtsEnabled,m=(0,o.useState)(),f=m[0],v=m[1];return(0,r.jsx)(a.Z,{className:"justify-content-cente",children:(0,r.jsx)(c.Z,{lg:"9",children:f?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"d-flex mb-3 align-items-center",children:(0,r.jsx)(l.Z,{color:"link",className:"p-0 position-absolut start-0",style:{top:"12px"},onClick:function(){v()},children:(0,r.jsx)(s.G,{icon:i.jio,color:"gray",size:"lg"})})}),(0,r.jsx)(R,{selectedDoubt:f})]}):(0,r.jsx)(I,{courseId:n,setSelectedDoubt:v,isFolderCourse:t,isMyDoubtsEnabled:u,isAllDoubtsEnabled:d})})})}},66961:function(e,n,t){t(85893),t(30381),t(96486),t(67294),t(89885),t(94322)},21359:function(e,n,t){var r=t(82670);n.Z=function(e){if(null===e||void 0===e)return!0;if("string"===typeof e)return""===e;if(Array.isArray(e)||"object"===typeof e&&null!==e){if((0,r.Z)(e,Map)||(0,r.Z)(e,Set))return 0===e.size;if(0===Object.keys(e).length)return!0}return!1}},58907:function(e,n,t){t.d(n,{c:function(){return y},s:function(){return N}});var r=t(47568),i=t(51438),s=t(28668),o=t(25892),a=t(76166),c=t(97582),l=t(87066),u=t(27432),d=function(e){(0,s.Z)(t,e);var n=(0,a.Z)(t);function t(e,r){var s;return(0,i.Z)(this,t),(s=n.call(this,e)).name="UploadError",s.status=r,s}return t}((0,o.Z)(Error)),m=function(e){return new Promise((function(n){return setTimeout(n,e)}))},f=function(e){return{400:"Invalid request format",401:"Unauthorized access",403:"Permission denied",404:"Resource not found",408:"Request timeout",413:"File too large",422:"File format not supported",429:"Too many requests",500:"Server error",503:"Service unavailable"}[e]||"Unknown error occurred"};function v(e){return p.apply(this,arguments)}function p(){return p=(0,r.Z)((function(e){var n,t,r,i,s,o,a,l,u,v,p,h,x,g,j=arguments;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:n=j.length>1&&void 0!==j[1]?j[1]:{},t=n.maxRetries,r=void 0===t?3:t,i=n.baseDelay,s=void 0===i?1e3:i,o=n.retryStatusCodes,a=void 0===o?[408,413,422,429,500,503]:o,u=0,c.label=1;case 1:if(!(u<=r))return[3,7];c.label=2;case 2:return c.trys.push([2,4,,6]),[4,e()];case 3:return[2,c.sent()];case 4:if(v=c.sent(),l=v,h=(null===(p=v.response)||void 0===p?void 0:p.status)||500,!a.includes(h)||u===r)throw x="".concat(f(h)," (Status: ").concat(h,")"),new d(x,h);return g=s*Math.pow(2,u),[4,m(g)];case 5:return c.sent(),[3,6];case 6:return u++,[3,1];case 7:throw l}}))})),p.apply(this,arguments)}var h=function(e){return e.replaceAll(" ","-").replaceAll("&","and").replaceAll("+","-")};function x(e,n,t){return g.apply(this,arguments)}function g(){return(g=(0,r.Z)((function(e,n,t){var r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return r={filePath:e},t&&(r.type="test"),[4,l.Z.post("/post/generateTencentWebsitePresignedUrl",r,{headers:{"Content-Type":n}})];case 1:return[2,i.sent().data.data]}}))}))).apply(this,arguments)}function j(e,n,t,r){return b.apply(this,arguments)}function b(){return(b=(0,r.Z)((function(e,n,t,r){return(0,c.__generator)(this,(function(i){return[2,l.Z.put(e,n,{headers:{"Content-Type":t},onUploadProgress:r})]}))}))).apply(this,arguments)}var y=function(){var e=(0,r.Z)((function(e){var n,t,i,s,o,a,l,d,m,f,p,g,b,y,N,_=arguments;return(0,c.__generator)(this,(function(Z){switch(Z.label){case 0:n=e.fileName,t=e.file,i=e.path,s=e.cb,o=e.progressCb,a=void 0===o?void 0:o,l=e.isTest,d=void 0!==l&&l,m=_.length>1&&void 0!==_[1]?_[1]:{maxRetries:0},Z.label=1;case 1:return Z.trys.push([1,3,,4]),f=h(n),p="".concat(i,"/").concat(f),g=u.Z.getType(n),b=function(){var e=(0,r.Z)((function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,x(p,g,d)];case 1:return[4,j((e=n.sent()).presignedUrl,t,g,a?function(e){a({loaded:e.loaded,total:e.total,lengthComputable:!0})}:void 0)];case 2:return n.sent(),[2,{Location:e.actualUrl}]}}))}));return function(){return e.apply(this,arguments)}}(),[4,v(b,m)];case 2:return y=Z.sent(),s(null,y),[2,y];case 3:throw N=Z.sent(),console.error("Error in uploadFile:",N),s(N,null),N;case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}();function N(e){return _.apply(this,arguments)}function _(){return _=(0,r.Z)((function(e){var n,t,r,i,s,o,a,l=arguments;return(0,c.__generator)(this,(function(c){return n=e.fileName,t=e.file,r=e.path,i=e.progressCb,s=void 0===i?void 0:i,o=e.isTest,a=void 0!==o&&o,[2,v((function(){return new Promise((function(e,i){y({fileName:n,file:t,path:r,cb:function(n,t){if(n)return console.error(n),void i(n);e(t)},progressCb:s,isTest:a})}))}),l.length>1&&void 0!==l[1]?l[1]:{maxRetries:0})]}))})),_.apply(this,arguments)}}}]);